# Задание 3. Внешние интеграции

### Список требований для интеграции «Умного дома» в PropDevelopment:

## 1. Требования к безопасности

Интеграция с сервисами партнёра должна обеспечивать защиту персональных данных, отказоустойчивость и контроль доступа.

### **Защита персональных данных**

- **Шифрование данных**:
  - Все передаваемые данные (видео, биометрия, номера авто) должны быть зашифрованы с использованием современных протоколов.
  - Чувстительные данные, такие как: пароли, банковские карты и т.д., хранящиеся в БД, должны быть зашифрованы.
- **Минимизация передаваемых данных**:
  - Передавать только **необходимую информацию** (например, хэш биометрии вместо оригинального изображения).
  - Исключить передачу **избыточных или чувствительных данных** без явного запроса.
- **Обезличивание и анонимизация**:
  - Хранение биометрических данных должно проходить через **хэширование и токенизацию**.
  - В отчётах и логах **не хранить открытые персональные данные**.

### **Защита от несанкционированного доступа**

- **Контроль доступа**:
  - Доступ к устройствам только через **авторизованных пользователей**.
  - Операции по управлению дверями/шлагбаумом должны **логироваться и проверяться**.
- **Защита от атак**:
  - Реализовать защиту от **Brute Force и DoS-атак**.
  - Ограничить количество запросов к API через **Rate Limiting**.
- **Логирование и аудит**:
  - Все запросы к системам должны **логироваться**.
  - Логи должны **храниться минимум 90 дней** и быть защищены от изменений.

______________________________________________________________________

## 2. Протоколы аутентификации и авторизации

### **Аутентификация**

- **OAuth 2.0 / OpenID Connect (OIDC)**:
  - Использовать **OAuth 2.0** для взаимодействия мобильного приложения с платформой.
  - Поддержка **PKCE (Proof Key for Code Exchange)** для защиты от атак.
  - Для взаимодействия между серверами использовать **JWT (JSON Web Token)**.
- **Многофакторная аутентификация (MFA)**:
  - Требовать MFA (например, SMS-код или Push-уведомление) для **добавления новых устройств**.

### **Авторизация**

- **Ролевая модель (RBAC)**:
  - Разделение прав для **собственников, администраторов, гостей**.

______________________________________________________________________

## 3. Организация взаимодействия между системами

Интеграция должна бесшовно работать с существующей IT-инфраструктурой PropDevelopment.

### **Общий принцип работы**

1. **Запрос доступа через мобильное приложение**
   - Пользователь отправляет запрос на вход через **приложение PropDevelopment**.
1. **Проверка прав доступа**
   - Система PropDevelopment проверяет **наличие разрешения в БД**.
1. **Передача команды в партнёрскую систему**
   - После подтверждения, отправляется API-запрос **в систему партнёра Smart Home**.
1. **Открытие двери/шлагбаума**
   - Устройство **получает команду** и открывает доступ.
1. **Фиксация события в логах**
   - Логи сохраняются в нашей системе.

### **API-взаимодействие**

- **REST API**:
  - Использовать REST API для передачи данных между PropDevelopment и партнёрской платформой.
  - Все запросы должны быть **подписаны и аутентифицированы**.

### С4 Context Diagram

![C4_context.drawio.svg](C4_context.drawio.svg)

### С4 Containers Diagram

![C4_containers.drawio.svg](C4_containers.drawio.svg)
